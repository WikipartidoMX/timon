<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="../unaColumnaTemplate.xhtml"
                xmlns:h="http://java.sun.com/jsf/html" 
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:param name="donde" value="menuregist" />
    
    <h1>Registro y Afiliación</h1>


    <ui:define name="head">
        <script type="text/javascript">
            var RecaptchaOptions = {
                lang : 'es'
            };
        </script>   
    </ui:define>

    <ui:define name="content">
        <h:panelGroup rendered="#{registro.miembro.paso == 1}">

            <div id="encabezadoPasos">
                YA ESTÁS REGISTRADO EN EL WIKI CON EL USUARIO #{registro.miembro.clavedeusuario} (<a href="http://wiki.wikipartido.mx/wiki/index.php?title=Especial:Entrar&amp;returnto=Página_principal">IR AL WIKI</a>)
            </div>
            <br/><br/>
            <div id="encabezadoPasos">
                SI NO TE HAS AFILIADO O QUIERES IMPRIMIR TU FORMA DE AFILIACIÓN <a href="afiliacion.xhtml">HAZLO AQUÍ</a>
            </div>            
        </h:panelGroup>
        <h:panelGroup rendered="#{registro.miembro.paso == 2}">

            <div id="encabezadoPasos">
                ¡YA ESTÁS AFILIADO AL WIKIPARTIDO! PUEDES <a href="http://wiki.wikipartido.mx/wiki/index.php?title=Especial:Entrar&amp;returnto=Página_principal">IR AL WIKI</a>
            </div>
            <br/><br/>
            <div id="encabezadoPasos">
                O SI QUIERES IMPRIMIR TU CONSTANCIA DE AFILIACIÓN <a href="afiliacion.xhtml">HAZLO AQUÍ</a>
            </div>            
        </h:panelGroup>          

        <br/>
        <h:panelGroup rendered="#{empty registro.miembro.paso}">
            <div id="encabezadoPasos">
                &rarr;PASO 1: REGISTRO EN EL WIKI (COLABORADOR) &nbsp;&nbsp; &nbsp;&nbsp; 
                <span style="color:#c9c9c9">PASO 2: AFILIACIÓN AL PARTIDO (DERECHO A VOTO)</span>
            </div>
            <p:ajaxStatus />
            <BR/>


            <h:form id="wikiform">
                <p:ajaxStatus />

                <div id="encabezadoFormaRegistro">
                    PASO 1. REGISTRO EN EL WIKI
                    <br/>
                    <div style="font-size: 12px;">
                        Tu registro te da derecho a crear y editar contenidos en el wiki,  
                        hacer propuestas y participar en las discusiones del wikipartido sin derecho a voto.
                        Regístrate utilizando tu nombre o si lo prefieres conservando el anonimato. 
                        Recuerda que sólo los miembros afiliados (Paso 2) pueden votar y que al afiliarte ayudas
                        a que el partido obtenga su registro en el 2014.

                    </div>
                </div>

                <div id="formaParaWiki">
                    <div class="campo">Clave de Usuario (La primera letra debe ser mayúscula, ej. JuanHernandez)</div>
                    <div class="valor">
                        <p:inputText size="21" id="clavedeusuario" required="true" validatorMessage="La clave de usuario no debe tener espacios ni caracteres especiales como acentos o eñes." requiredMessage="La clave de usuario es requerida" style="font-size: 24px; color:grey;" value="#{registro.miembro.clavedeusuario}">
                            <f:ajax event="blur" render="errorclavedeusuario"  />
                            <f:validateRegex pattern="^[A-Za-z0-9_-]{3,30}$"  />
                        </p:inputText><br/>
                        <h:message for="clavedeusuario" id="errorclavedeusuario" style="color:red"/>
                    </div>
                    <div class="campo">Correo Electrónico</div>
                    <div class="valor">
                        <p:inputText id="email" size="45" style="font-size: 24px; color:grey;" value="#{registro.miembro.email}" required="true" requiredMessage="El e-Mail es requerido." validatorMessage="El e-Mail no es válido">
                            <f:validateRegex pattern="^(([A-Za-z0-9]+_+)|([A-Za-z0-9]+\-+)|([A-Za-z0-9]+\.+)|([A-Za-z0-9]+\++))*[A-Za-z0-9]+@((\w+\-+)|(\w+\.))*\w{1,63}\.[a-zA-Z]{2,6}$"/>

                            <f:ajax event="blur" render="errormail" />
                        </p:inputText><br/>
                        <h:message for="email" id="errormail" style="color:red"/>
                    </div>
                    <div>
                        <div class="campo">Contraseña <h:message for="pass" id="errorpass" style="color:red"/></div>
                        <div class="valor">
                            <p:password id="pass" promptLabel="Ingrese una contraseña"  weakLabel="Débil" goodLabel="Buena" strongLabel="Fuerte"  required="true" requiredMessage="CONTRASEÑA REQUERIDA" size="20" style="font-size: 24px; margin-right: 15px; color:grey;" value="#{registro.miembro.password}">
                                <f:ajax event="blur" render="errorpass"  />
                            </p:password>
                        </div>
                    </div>                

                    <div style="clear:both" />
                    Ingresa las palabras que aparecen aquí:<br/><br/>
                    <p:captcha label="Captcha" id="captcha" language="es" validatorMessage="El valor del captcha es incorrecto" />
                    <h:message for="captcha" id="errorcaptcha" style="color:red"/>
                    <br/>
                    <ui:include src="../avisolegal.xhtml" />
                    <br/>
                    <p:messages id="mensajes" />

                    <p:commandButton value="REGISTRAR EN EL WIKI" ajax="false" update="mensajes, wikiform" action="#{registro.agregarAlWiki}" />


                </div>

            </h:form>
        </h:panelGroup>
        <br/><br/>

    </ui:define>



</ui:composition>
